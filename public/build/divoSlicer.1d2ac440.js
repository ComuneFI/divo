(window.webpackJsonp=window.webpackJsonp||[]).push([["divoSlicer"],{NIsQ:function(e,i,o){"use strict";o.r(i),function(e){var i=o("PSD3"),n=o.n(i);e(document).ready((function(){console.log("[ok] DivoSlicer loaded v.0.1.3")}));var t={request:{failed:"Request failed",sending:"Errore durante invio dati"}},r={send:{data:"Dati che verranno inviati: "},swal:{success:"Operazione conclusa",info:"Informazioni",error:"Errore",warning:"Operazione conclusa con alcune anomalie"}},a={swal:{success:"Operazione conclusa con successo!",info:"Dati da gestire non rilevati",error:"Si è verificato un errore. Controllare la correttezza della richiesta.",warning:"Operazione conclusa con alcune anomalie"}},s={fine:"sezioni corrette"},c=function(i,o,n){var r=e.Deferred();return e.getJSON(i,{start:o,end:n}).done((function(e){r.resolve(e)})).fail((function(e,i,o){var n=i+", "+o;console.log(t.failed+n)})),r.promise()},l=function(e,i){return{esito:{esito:{codice:e,descrizione:i}}}},u=function(i,o,n){var r=e.Deferred(),c=0,u=!1,d=null;405==n.esito.esito.codice&&(u=!0,d=n.esito);var f=n.array,v=f.length;e("#mynode").html("... "+v);var h=[],m="<ul>",w=0;e(f).each((function(){var i=this.id;h[i]=e.Deferred()})),e.when.apply(e,h).done((function(e){if(m+="</ul>",u)var i=l(d.esito.codice,d.esito.descrizione);else if(w==v){var o=" ("+w+"/"+v+" "+s.fine+")";i=l(1,a.swal.success+o)}else o=" ("+w+"/"+v+" "+s.fine+")<br>"+m,i=l(2,a.swal.warning+o);r.resolve(i)}));var p="/service/post/"+o;return e(f).each((function(){var i=this.id,o=this.desc;e.getJSON(p+"/"+i,(function(e){1==e.esito.esito.codice?w+=1:m+="<li>"+o+" - "+e.esito.esito.descrizione+"</li>",h[i].resolve(e.result)})).fail((function(){m+="<li>"+o+" - "+t.request.sending+"</li>",h[i].resolve()})).always((function(){c+=1,e("#mynode").html(c+"/"+v)}))})),r.promise()};e(".multiSlicer").click((function(){var i=e(this).data("eventid"),o=e(this).data("topic"),t=e(this).data("topic-text"),s=e(this).data("path"),l=e("#start-sec-"+i).val(),d=e("#end-sec-"+i).val();n.a.fire({title:"Invio "+o,html:r.send.data+t+'<br>Invio sezioni <span id="mynode"></span>',showCancelButton:!0,confirmButtonText:"Procedi",showLoaderOnConfirm:!0,preConfirm:function(){return function(i,o,n,t){var r=e.Deferred();return c(i,n,t).then((function(e){u(i,o,e).then((function(e){r.resolve(e)}))})),r.promise()}(s,o,l,d)},allowOutsideClick:function(){return!n.a.isLoading()}}).then((function(e){e.value?void 0===e.value.esito?n.a.fire(r.swal.error,a.swal.error,"error"):1==e.value.esito.esito.codice?n.a.fire({title:r.swal.success,html:e.value.esito.esito.descrizione,icon:"success"}).then((function(){location.reload()})):405==e.value.esito.esito.codice?n.a.fire(r.swal.info,e.value.esito.esito.descrizione,"info"):n.a.fire({title:r.swal.warning,html:e.value.esito.esito.descrizione,icon:"warning"}).then((function(){location.reload()})):n.a.fire(r.swal.info,a.swal.info,"info")}))})),e(".divo-post-data").click((function(){var i=e(this).data("topic"),o=e(this).data("itemid");n.a.fire({title:"Invio Dati",text:"Vuoi procedere con l'invio dei dati?",showCancelButton:!0,confirmButtonText:"Procedi",showLoaderOnConfirm:!0,preConfirm:function(){return e.ajax({type:"POST",url:"/service/post/"+i+"/"+o}).fail((function(e,i){n.a.fire("","Attenzione si è verificato un errore:"+e.responseText,"error")})).catch((function(e){console.log(e.responseText)}))},allowOutsideClick:function(){return!n.a.isLoading()}}).then((function(e){e.value?void 0===e.value.esito?n.a.fire("Errore","Errore interno generico, contattare l'amministratore del sistema","error"):1==e.value.esito.esito.codice?n.a.fire({title:"Invio concluso",html:e.value.esito.esito.descrizione,icon:"success"}).then((function(){location.reload()})):n.a.fire("Dati inseriti non corretti",e.value.esito.esito.descrizione,"info"):n.a.fire("Nessun risultato","Chiedere assistenza all'amministratore del sistema","error")}))}))}.call(this,o("EVdn"))}},[["NIsQ","runtime",0,1]]]);